# æ•°æ®åº“ç»“æ„æ–‡æ¡£ - record.db

**æ›´æ–°æ—¶é—´**: 2026-01-09  
**æ•°æ®åº“**: SQLite3 (data/record.db)  
**æ€»è¡¨æ•°**: 20 ä¸ª | **æ€»è®°å½•æ•°**: 141,493 æ¡

---

## ğŸ“Š è¡¨çŠ¶æ€ç»Ÿè®¡

### å·²å¡«å……è¡¨ (9 ä¸ª)

| è¡¨å | è®°å½•æ•° | è¯´æ˜ |
|------|--------|------|
| customer | 24 | å®¢æˆ·ä¿¡æ¯ |
| customer_contact | 69 | è”ç³»äºº |
| purchase_order | 172 | é‡‡è´­è®¢å• |
| job | 339 | ä½œä¸š |
| order_item | 358 | è®¢å•æ˜ç»† |
| part | 1,657 | é›¶ä»¶ (å« Assembly) |
| part_tree | 1,460 | BOM ç»“æ„ |
| drawing_file | 137,399 | å›¾çº¸æ–‡ä»¶ (Gç›˜æ‰«æ) |
| shipment / shipment_item | 5 / 10 | å‘è´§å• |

### ç©ºè¡¨ (11 ä¸ª)

| è¡¨å | è¯´æ˜ |
|------|------|
| part_attachment | é›¶ä»¶é™„ä»¶ |
| folder_mapping | å®¢æˆ·æ–‡ä»¶å¤¹æ˜ å°„ |
| process_template | å·¥è‰ºæ¨¡æ¿ |
| step_tracker | æ­¥éª¤è¿½è¸ª |
| po_note / job_note / order_item_note | å¤‡æ³¨è¡¨ |
| part_note / shipment_note / attachment_note | å¤‡æ³¨è¡¨ |

---

## ğŸ›¢ï¸ æ ¸å¿ƒè¡¨ç»“æ„

###### **customer**

```
å­—æ®µ: 6
è®°å½•: 24

id (PK, INTEGER)
customer_name (TEXT NOT NULL)
usage_count (INTEGER DEFAULT 0)
last_used (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **customer_contact**

```
å­—æ®µ: 8
è®°å½•: 69

id (PK, INTEGER)
customer_id (INTEGER NOT NULL) -> customer.id
contact_name (TEXT NOT NULL)
contact_email (TEXT)
usage_count (INTEGER DEFAULT 0)
last_used (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **purchase_order**

```
å­—æ®µ: 8
è®°å½•: 172

id (PK, INTEGER)
po_number (TEXT NOT NULL)
oe_number (TEXT)
contact_id (INTEGER) -> customer_contact.id
is_active (INTEGER DEFAULT 1)
closed_at (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **job**

```
å­—æ®µ: 6
è®°å½•: 339

id (PK, INTEGER)
job_number (TEXT NOT NULL UNIQUE)
po_id (INTEGER NOT NULL) -> purchase_order.id
priority (TEXT DEFAULT 'Normal')
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **order_item**

```
å­—æ®µ: 13
è®°å½•: 358

id (PK, INTEGER)
job_id (INTEGER NOT NULL) -> job.id
part_id (INTEGER) -> part.id
line_number (INTEGER NOT NULL)
quantity (INTEGER NOT NULL DEFAULT 0)
actual_price (REAL)
production_hour (REAL DEFAULT 0)
administrative_hour (REAL DEFAULT 0)
status (TEXT DEFAULT 'PENDING')
drawing_release_date (TEXT)
delivery_required_date (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **part**

```
å­—æ®µ: 13
è®°å½•: 1,657

id (PK, INTEGER)
previous_id (INTEGER) -> part.id (å†å²ç‰ˆæœ¬é“¾)
next_id (INTEGER) -> part.id (å†å²ç‰ˆæœ¬é“¾)
drawing_number (TEXT NOT NULL)
revision (TEXT NOT NULL DEFAULT '-')
description (TEXT)
is_assembly (INTEGER DEFAULT 0)
production_count (INTEGER DEFAULT 0)
total_production_hour (REAL DEFAULT 0)
total_administrative_hour (REAL DEFAULT 0)
unit_price (REAL DEFAULT 0)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))

å¤‡æ³¨: UNIQUE(drawing_number, revision)
```

###### **part_tree**

```
å­—æ®µ: 6
è®°å½•: 1,460

id (PK, INTEGER)
parent_id (INTEGER NOT NULL) -> part.id
child_id (INTEGER NOT NULL) -> part.id
quantity (INTEGER DEFAULT 1)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))

è¯´æ˜: BOM ç»“æ„ï¼Œè®°å½•é›¶ä»¶ç»„æˆå…³ç³»
```

###### **drawing_file**

```
å­—æ®µ: 9
è®°å½•: 137,399

id (PK, INTEGER)
part_id (INTEGER) -> part.id
file_name (TEXT NOT NULL)
file_path (TEXT NOT NULL UNIQUE)
is_active (INTEGER DEFAULT 1)
last_modified_at (TEXT)
revision (TEXT NOT NULL DEFAULT '-')
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))

è¯´æ˜: G ç›˜æ‰«æç»“æœï¼Œpart_id å¯ä¸ºç©ºï¼ˆåæœŸæ‰‹å·¥åŒ¹é…ï¼‰
```

###### **part_attachment**

```
å­—æ®µ: 10
è®°å½•: 0

id (PK, INTEGER)
part_id (INTEGER) -> part.id
order_item_id (INTEGER) -> order_item.id
file_type (TEXT NOT NULL)  -- INSPECTION, MTR, DEVIATION
file_name (TEXT NOT NULL)
file_path (TEXT NOT NULL UNIQUE)
is_active (INTEGER DEFAULT 1)
last_modified_at (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))

è¯´æ˜: é›¶ä»¶é™„ä»¶è¡¨ï¼ˆè´¨æ£€æŠ¥å‘Šã€MTRç­‰ï¼‰
```

###### **shipment**

```
å­—æ®µ: 6
è®°å½•: 5

id (PK, INTEGER)
packing_slip_number (TEXT NOT NULL UNIQUE)
invoice_number (TEXT)
delivery_shipped_date (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **shipment_item**

```
å­—æ®µ: 6
è®°å½•: 10

id (PK, INTEGER)
order_item_id (INTEGER NOT NULL) -> order_item.id
shipment_id (INTEGER NOT NULL) -> shipment.id
quantity (INTEGER NOT NULL DEFAULT 0)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **folder_mapping**

```
å­—æ®µ: 6
è®°å½•: 0

id (PK, INTEGER)
customer_id (INTEGER NOT NULL) -> customer.id
folder_name (TEXT NOT NULL)
is_verified (INTEGER DEFAULT 0)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))

è¯´æ˜: å®¢æˆ· G ç›˜æ–‡ä»¶å¤¹æ˜ å°„
```

###### **process_template**

```
å­—æ®µ: 8
è®°å½•: 0

id (PK, INTEGER)
part_id (INTEGER NOT NULL) -> part.id
row_number (INTEGER NOT NULL)
shop_code (TEXT NOT NULL)
description (TEXT)
remark (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))

è¯´æ˜: ç”Ÿäº§å·¥è‰ºæ¨¡æ¿
```

###### **step_tracker**

```
å­—æ®µ: 10
è®°å½•: 0

id (PK, INTEGER)
order_item_id (INTEGER NOT NULL) -> order_item.id
process_template_id (INTEGER NOT NULL) -> process_template.id
operator_id (TEXT)
machine_id (TEXT)
status (TEXT DEFAULT 'PENDING')
start_time (TEXT)
end_time (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))

è¯´æ˜: ç”Ÿäº§æ­¥éª¤è¿½è¸ªï¼ˆæ¡ç æ‰«æè®°å½•ï¼‰
```

---

## ğŸ“ å¤‡æ³¨è¡¨

æ‰€æœ‰å¤‡æ³¨è¡¨éµå¾ªç»Ÿä¸€æ¨¡å¼ï¼Œæ”¯æŒå¤šè¡¨å…³è”ï¼š

###### **po_note**

```
å­—æ®µ: 6
è®°å½•: 0

id (PK, INTEGER)
po_id (INTEGER NOT NULL) -> purchase_order.id
content (TEXT NOT NULL)
author (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **job_note**

```
å­—æ®µ: 6
è®°å½•: 0

id (PK, INTEGER)
job_id (INTEGER NOT NULL) -> job.id
content (TEXT NOT NULL)
author (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **order_item_note**

```
å­—æ®µ: 6
è®°å½•: 0

id (PK, INTEGER)
order_item_id (INTEGER NOT NULL) -> order_item.id
content (TEXT NOT NULL)
author (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **part_note**

```
å­—æ®µ: 6
è®°å½•: 0

id (PK, INTEGER)
part_id (INTEGER NOT NULL) -> part.id
content (TEXT NOT NULL)
author (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **shipment_note**

```
å­—æ®µ: 6
è®°å½•: 0

id (PK, INTEGER)
shipment_id (INTEGER NOT NULL) -> shipment.id
content (TEXT NOT NULL)
author (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

###### **attachment_note**

```
å­—æ®µ: 6
è®°å½•: 0

id (PK, INTEGER)
attachment_id (INTEGER NOT NULL) -> part_attachment.id
content (TEXT NOT NULL)
author (TEXT)
created_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
updated_at (TEXT NOT NULL DEFAULT datetime('now', 'localtime'))
```

---

## ğŸ”— å…³é”®å…³ç³»

```
customer
â”œâ”€â”€ customer_contact (1:N)
â”‚   â””â”€â”€ purchase_order (1:N)
â”‚       â””â”€â”€ job (1:N)
â”‚           â””â”€â”€ order_item (1:N)
â”‚               â”œâ”€â”€ shipment_item (1:N)
â”‚               â”‚   â””â”€â”€ shipment (N:1)
â”‚               â””â”€â”€ part (1:1)
â”‚                   â”œâ”€â”€ part_tree (parent:children 1:N)
â”‚                   â”œâ”€â”€ drawing_file (1:N)
â”‚                   â”œâ”€â”€ part_attachment (1:N)
â”‚                   â””â”€â”€ process_template (1:N)
â”‚                       â””â”€â”€ step_tracker (1:N)
```

---

## ğŸ“ˆ æ•°æ®ç»Ÿè®¡

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| å®¢æˆ· | 24 |
| è”ç³»äºº | 69 |
| é‡‡è´­è®¢å• | 172 |
| ä½œä¸š | 339 |
| è®¢å•æ˜ç»† | 358 |
| é›¶ä»¶ | 1,657 |
| BOM å…³ç³» | 1,460 |
| å›¾çº¸æ–‡ä»¶ | 137,399 |
| å‘è´§å• | 5 |
| å‘è´§æ˜ç»† | 10 |

---

## âš ï¸ ç‰¹æ®Šè¯´æ˜

1. **drawing_file æ•°æ®é‡å¤§** (137,399) - æ¥è‡ª G ç›˜å…¨é‡æ‰«æï¼Œpart_id å¤§å¤šä¸º NULLï¼Œéœ€åæœŸåŒ¹é…
2. **part_tree è‡ªåŠ¨ç”Ÿæˆ** (1,460) - ä» part.previous_id / next_id é“¾æ¨å¯¼çš„ BOM å…³ç³»
3. **order_item.part_id å¯ä¸ºç©º** - æœ‰ 3 æ¡è®¢å•æ˜ç»†æœªå…³è”é›¶ä»¶
4. **æ‰€æœ‰æ—¶é—´æˆ³** - ä½¿ç”¨æœ¬åœ°æ—¶é—´æ ¼å¼ (datetime('now', 'localtime'))
5. **è½¯åˆ é™¤** - ä½¿ç”¨ is_active æ ‡å¿—è€Œéç¡¬åˆ é™¤

